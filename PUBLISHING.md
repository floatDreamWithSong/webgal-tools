# WebGAL MCP å‘å¸ƒæŒ‡å—

æœ¬æ–‡æ¡£è¯´æ˜å¦‚ä½•åˆ†å‘ `apps` ä¸‹çš„å¤šä¸ªå­åŒ…ã€‚

## ğŸ“¦ åŒ…ç»“æ„

```
webgal-mcp/
â”œâ”€â”€ apps/
â”‚   â”œâ”€â”€ mcp-server/     # MCPæœåŠ¡å™¨åº”ç”¨ (@webgal-mcp/mcp-server)
â”‚   â””â”€â”€ voice/          # è¯­éŸ³åˆæˆåº”ç”¨ (@webgal-mcp/voice)
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ config/         # é…ç½®åŒ… (@webgal-mcp/config)
â”‚   â””â”€â”€ logger/         # æ—¥å¿—åŒ… (@webgal-mcp/logger)
â””â”€â”€ scripts/
    â””â”€â”€ publish.js      # å‘å¸ƒè„šæœ¬
```

## ğŸš€ å‘å¸ƒæµç¨‹

### 1. å‡†å¤‡å·¥ä½œ

ç¡®ä¿ä½ å·²ç»ï¼š
- ç™»å½•åˆ° npmï¼š`pnpm login`
- æœ‰å‘å¸ƒæƒé™åˆ° `@webgal-mcp` ç»„ç»‡ï¼ˆæˆ–åˆ›å»ºè¯¥ç»„ç»‡ï¼‰
- ä»£ç å·²ç»æäº¤åˆ° git

**æ³¨æ„**ï¼šæ‰€æœ‰åŒ…éƒ½é…ç½®ä¸ºå…¬å…±åŒ…ï¼ˆ`"access": "public"`ï¼‰ï¼Œè¿™æ„å‘³ç€ä»»ä½•äººéƒ½å¯ä»¥å®‰è£…ä½¿ç”¨ï¼Œæ— éœ€ä»˜è´¹ã€‚

### 2. æ£€æŸ¥å½“å‰çŠ¶æ€

```bash
pnpm run publish:check
```

è¿™ä¼šæ˜¾ç¤ºæ‰€æœ‰åŒ…çš„å½“å‰ç‰ˆæœ¬å·ã€‚

### 3. æ›´æ–°ç‰ˆæœ¬å·

```bash
# æ›´æ–°æ‰€æœ‰åŒ…åˆ°æ–°ç‰ˆæœ¬
pnpm run publish:version 1.6.0

# æˆ–è€…ä½¿ç”¨è„šæœ¬
node scripts/publish.js version 1.6.0
```

### 4. æ„å»ºæ‰€æœ‰åŒ…

```bash
pnpm run publish:build
```

### 5. å‘å¸ƒåŒ…

#### å‘å¸ƒæ­£å¼ç‰ˆæœ¬
```bash
pnpm run publish:all
```

#### å‘å¸ƒæµ‹è¯•ç‰ˆæœ¬
```bash
# å‘å¸ƒ beta æ ‡ç­¾
node scripts/publish.js publish 1.6.0 beta
```

#### ä¸€é”®å‘å¸ƒï¼ˆæ„å»º + å‘å¸ƒï¼‰
```bash
pnpm run release
```

## ğŸ“‹ å‘å¸ƒé¡ºåº

å‘å¸ƒè„šæœ¬ä¼šè‡ªåŠ¨æŒ‰ä»¥ä¸‹é¡ºåºå‘å¸ƒï¼š

1. **packages/config** - é…ç½®åŒ…
2. **packages/logger** - æ—¥å¿—åŒ…  
3. **apps/mcp-server** - MCPæœåŠ¡å™¨åº”ç”¨
4. **apps/voice** - è¯­éŸ³åˆæˆåº”ç”¨

è¿™ä¸ªé¡ºåºç¡®ä¿äº†ä¾èµ–å…³ç³»æ­£ç¡®ã€‚

## ğŸ·ï¸ ç‰ˆæœ¬æ ‡ç­¾

- `latest` - æ­£å¼ç‰ˆæœ¬ï¼ˆé»˜è®¤ï¼‰
- `beta` - æµ‹è¯•ç‰ˆæœ¬
- `alpha` - é¢„è§ˆç‰ˆæœ¬

## ğŸ“ å‘å¸ƒå†…å®¹

æ¯ä¸ªåŒ…åªä¼šå‘å¸ƒä»¥ä¸‹å†…å®¹ï¼š

### apps/mcp-server
- `dist/**/*` - ç¼–è¯‘åçš„ä»£ç 
- `resource/**/*` - èµ„æºæ–‡ä»¶

### apps/voice  
- `dist/**/*` - ç¼–è¯‘åçš„ä»£ç 

### packages/*
- `dist/**/*` - ç¼–è¯‘åçš„ä»£ç 
- `package.json` - åŒ…é…ç½®

## ğŸ”§ æ‰‹åŠ¨å‘å¸ƒ

å¦‚æœéœ€è¦æ‰‹åŠ¨å‘å¸ƒå•ä¸ªåŒ…ï¼š

```bash
# è¿›å…¥åŒ…ç›®å½•
cd apps/mcp-server

# æ„å»º
pnpm run build

# å‘å¸ƒ
pnpm publish --tag latest
```

## ğŸ› æ•…éšœæ’é™¤

### å‘å¸ƒå¤±è´¥
1. æ£€æŸ¥æ˜¯å¦å·²ç™»å½• npmï¼š`pnpm whoami`
2. æ£€æŸ¥åŒ…åæ˜¯å¦æ­£ç¡®
3. æ£€æŸ¥ç‰ˆæœ¬å·æ˜¯å¦å·²å­˜åœ¨
4. æ£€æŸ¥æ˜¯å¦æœ‰å‘å¸ƒæƒé™
5. å¦‚æœæ˜¯ 402 é”™è¯¯ï¼Œè¯´æ˜éœ€è¦ä»˜è´¹å‘å¸ƒç§æœ‰åŒ…ï¼Œè¯·ç¡®ä¿åŒ…é…ç½®ä¸ºå…¬å…±åŒ…ï¼ˆ`"access": "public"`ï¼‰

### ä¾èµ–é—®é¢˜
1. ç¡®ä¿ `packages` å…ˆäº `apps` å‘å¸ƒ
2. æ£€æŸ¥ `workspace:*` ä¾èµ–æ˜¯å¦æ­£ç¡®è§£æ

### æ„å»ºå¤±è´¥
1. è¿è¡Œ `pnpm run clean` æ¸…ç†
2. é‡æ–°å®‰è£…ä¾èµ–ï¼š`pnpm install`
3. æ£€æŸ¥ TypeScript é”™è¯¯

## ğŸ“ å‘å¸ƒæ£€æŸ¥æ¸…å•

- [ ] ä»£ç å·²æäº¤åˆ° git
- [ ] æ‰€æœ‰æµ‹è¯•é€šè¿‡
- [ ] ç‰ˆæœ¬å·å·²æ›´æ–°
- [ ] å·²ç™»å½• npm
- [ ] æœ‰å‘å¸ƒæƒé™
- [ ] æ„å»ºæˆåŠŸ
- [ ] å‘å¸ƒæˆåŠŸ

## ğŸ”„ è‡ªåŠ¨åŒ–å‘å¸ƒ

å¯ä»¥é…ç½® GitHub Actions æ¥è‡ªåŠ¨åŒ–å‘å¸ƒæµç¨‹ï¼š

```yaml
name: Publish
on:
  push:
    tags:
      - 'v*'

jobs:
  publish:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
        with:
          node-version: '18'
      - run: pnpm install
      - run: pnpm run release
        env:
          NODE_AUTH_TOKEN: ${{ secrets.NPM_TOKEN }}
```

## ğŸ“ æ”¯æŒ

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·ï¼š
1. æ£€æŸ¥æœ¬æ–‡æ¡£
2. æŸ¥çœ‹ npm å‘å¸ƒæ—¥å¿—
3. è”ç³»é¡¹ç›®ç»´æŠ¤è€… 